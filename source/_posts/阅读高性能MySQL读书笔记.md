---
title: 阅读高性能MySQL读书笔记
date: 2017-12-16 15:11:51
tags:
categories: 阅读
---
# 存储引擎
## 日志型应用的存储引擎的选型（p26）
对插入速度要求较高，可以选用MyISAM或者Archive（只支持INSERT和SELECT操作，数据会压缩，所以磁盘io更小，支持高并发，适合数据采集）存储引擎，因为他们开销低、插入速度快
## 如何解决生成报表（执行sql）导致数据插入的效率降低
思路：读（报表）写（插入数据）分离
- 复制数据到备库，报表操作对备库进行操作，不会影响主库的插入效率
- 日志记录表中添加年月等信息，比如（现在是18年1月）web_logs_2017_12记录的是12月份的数据，2018年1月的数据是记录到web_logs_2018_01毕总中，报表只对web_logs_2017_12进行操作，不会影响2018年1月的数据的插入
<!-- more -->
# 基准测试(benchmark)

## 为什么要进行基准测试
基准测试是针对系统设计的一种压力测试。通常的目标是为了掌握系统的行为（在给定的工作负载下会发生什么）。但也有其他原因，如重现某个系统的状态，或者是做新硬件的可靠性测试
## 基准测试的策略
-  针对整个系统的整体测试,也被称为集成式(full-stack)
- 单独测试MySQL，也被称为单组件式(single-component)

## 为什么要进行集成式测试
- 测试整个应用系统，包括Web服务器、应用代码、网络和数据库是非常有用的，因为用户关注的并不仅仅是MySQL本身的性能，而是应用整体的性能
- MySQL并非总是应用的瓶颈，通过整体的测试可以揭示这一点
- 只有对应用做整体测试，才能发现各部分之间的缓存带来的影响
- 整体应用的集成式测试更能揭示应用的真实表现，而单独组件的测试很难做到这一点

## 基准测试的指标
- 吞吐量
吞吐量是指单位时间内的事务处理数
- 影响时间或者延迟
- 并发性
web应用程序的并发并不等于Mysql的并发，可以通过sysbench指定32，64或者128个线程的测试，然后在测试期间内记录Mysql数据库的Threads_running状态值
- 可扩展性
给系统增加一倍的工作，在理想情况下就能获得两倍的结果，比如给系统增加一倍的资源，就可以获得两倍的吞吐量

## 集成式测试工具与单组件式测试工具
- 集成式测试工具：ab、http_load、JMeter
- 单组件式测试工具:mysqlslap sql-bench syybench等